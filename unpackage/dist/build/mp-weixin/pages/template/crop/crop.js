(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/template/crop/crop"],{2902:function(t,e,c){},4203:function(t,e,c){"use strict";c.r(e);var a=c("951f"),i=c.n(a);for(var r in a)"default"!==r&&function(t){c.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},"8bf4":function(t,e,c){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},i=[];c.d(e,"a",function(){return a}),c.d(e,"b",function(){return i})},"951f":function(t,e,c){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c,a,i,r,u,o,s,n,h,p,g,d=t.getSystemInfoSync(),f=d.screenWidth,l=(d.pixelRatio,1),m=100,v=d.screenWidth,b={data:function(){return{name:"杨大宝",imageSrc:"https://img-cdn-qiniu.dcloud.net.cn/demo_crop.jpg",isShowImg:!1,cropperInitW:f,cropperInitH:f,cropperW:f,cropperH:f,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:f,cutR:"100%",qualityWidth:v,innerAspectRadio:l}},onLoad:function(t){},onReady:function(){this.loadImage()},methods:{setData:function(t){var e=this;Object.keys(t).forEach(function(c){e.$set(e.$data,c,t[c])})},getImage:function(){var e=this;t.chooseImage({success:function(t){e.setData({imageSrc:t.tempFilePaths[0]}),e.loadImage()}})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(c){h=c.width/c.height,h>=1?(p=f,g=f/h):(p=f*h,g=f);var a=p>g?p:g;if(m=a>m?m:a,h>=1){var i=Math.ceil((f/h-(f/h-m))/2),r=i,u=Math.ceil((f-f+m)/2),o=u;e.setData({cropperW:f,cropperH:f/h,cropperL:Math.ceil((f-f)/2),cropperT:Math.ceil((f-f/h)/2),cutL:u,cutT:i,cutR:o,cutB:r,imageW:p,imageH:g,scaleP:p/f,qualityWidth:v,innerAspectRadio:h})}else{var s=Math.ceil((f*h-f*h)/2),n=s,d=Math.ceil((f-m)/2),l=d;e.setData({cropperW:f*h,cropperH:f,cropperL:Math.ceil((f-f*h)/2),cropperT:Math.ceil((f-f)/2),cutL:s,cutT:d,cutR:n,cutB:l,imageW:p,imageH:g,scaleP:p/f,qualityWidth:v,innerAspectRadio:h})}e.setData({isShowImg:!0}),t.hideLoading()}})},contentStartMove:function(t){c=t.touches[0].pageX,a=t.touches[0].pageY},contentMoveing:function(t){var e=(c-t.touches[0].pageX)*l,i=(a-t.touches[0].pageY)*l;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),i>0?this.cutT-i<0&&(i=this.cutT):this.cutB+i<0&&(i=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-i,cutR:this.cutR+e,cutB:this.cutB+i}),c=t.touches[0].pageX,a=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var e=this;t.showLoading({title:"图片生成中..."});var c=t.createCanvasContext("myCanvas");c.drawImage(e.imageSrc,0,0,p,g),c.draw(!0,function(){var c=(e.cropperW-e.cutL-e.cutR)/e.cropperW*p,a=(e.cropperH-e.cutT-e.cutB)/e.cropperH*g,i=e.cutL/e.cropperW*p,r=e.cutT/e.cropperH*g;t.canvasToTempFilePath({x:i,y:r,width:c,height:a,destWidth:c,destHeight:a,quality:.5,canvasId:"myCanvas",success:function(e){t.hideLoading(),t.previewImage({current:"",urls:[e.tempFilePath]})}})})},dragStart:function(t){i=t.touches[0].pageX,r=t.touches[0].pageY,u=this.cutL,s=this.cutR,n=this.cutB,o=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var c=(i-t.touches[0].pageX)*l;s+c<0&&(c=-s),this.setData({cutR:s+c});break;case"left":c=(i-t.touches[0].pageX)*l;u-c<0&&(c=u),u-c>this.cropperW-this.cutR&&(c=u-(this.cropperW-this.cutR)),this.setData({cutL:u-c});break;case"top":c=(r-t.touches[0].pageY)*l;o-c<0&&(c=o),o-c>this.cropperH-this.cutB&&(c=o-(this.cropperH-this.cutB)),this.setData({cutT:o-c});break;case"bottom":c=(r-t.touches[0].pageY)*l;n+c<0&&(c=-n),this.setData({cutB:n+c});break;case"rightBottom":var a=(i-t.touches[0].pageX)*l,h=(r-t.touches[0].pageY)*l;n+h<0&&(h=-n),s+a<0&&(a=-s);var p=n+h,g=s+a;this.setData({cutB:p,cutR:g});break;default:break}}}};e.default=b}).call(this,c("543d")["default"])},9556:function(t,e,c){"use strict";c.r(e);var a=c("8bf4"),i=c("4203");for(var r in i)"default"!==r&&function(t){c.d(e,t,function(){return i[t]})}(r);c("b04a");var u=c("2877"),o=Object(u["a"])(i["default"],a["a"],a["b"],!1,null,null,null);e["default"]=o.exports},b04a:function(t,e,c){"use strict";var a=c("2902"),i=c.n(a);i.a}},[["af73","common/runtime","common/vendor"]]]);